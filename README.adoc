= Vehicle
Thomas Stütz
1.0.0, {docdate}
ifndef::imagesdir[:imagesdir: images]
:icons: font
:sectnums:    // Nummerierung der Überschriften / section numbering
// :toc:
// :toclevels: 1
:experimental:
//https://gist.github.com/dcode/0cfbf2699a1fe9b46ff04c41721dda74?permalink_comment_id=3948218
ifdef::env-github[]
:tip-caption: :bulb:
:note-caption: :information_source:
:important-caption: :heavy_exclamation_mark:
:caution-caption: :fire:
:warning-caption: :warning:
endif::[]


== Aufgabenstellung

* REST-API für Fahrzeuge, mit folgenden Funktionalitäten (Backend):

** Fahrzeuge anlegen, ändern, löschen und abfragen
** Fahrzeuge nach verschiedenen Kriterien suchen
** Bilder zu Fahrzeugen hochladen und herunterladen
** Fahrzeuge in einer Datenbank persistieren

* Frontend für die REST-API, um deren Funktionalitäten ausführen zu können.

== Implementierungshinweise

* Backend: Quarkus
** Das Repository-Pattern ist zu verwenden
** Persistierung mit Panache Persistence (Hibernate ORM)

* Datenbank: H2 (network-mode)
* Frontend: Angular

* Bilder: Im Verzeichnis `src/main/resources/META-INF/resources/download/` stehen die Bilder der einzelnen Fahrzeuge zur Verfügung. Dies ermöglicht den direkten Zugriff auf die Bilder über den Webserver: zB http://localhost:8080/download/ford-torino-1969.jpeg

.Folgende Bilder stehen zur Verfügung: [Click to expand]
[%collapsible]
====
* Bilder
** alfa-romeo-2000-berlina-1971.jpeg
** alfa-romeo-2000-berlina-1971-2.jpeg
** buick-century-riviera-1955.jpeg
** buick-gsx-1970.jpeg
** chevrolet-impala-1960.jpeg
** chevrolet-nova-1967.jpeg
** fiat-multipla-1962.jpeg
** ford-escort-ghia-1.6-1982.jpeg
** ford-mustang-fastback-1968.jpeg
** ford-torino-1969.jpeg
** gmc-100-pickup-1954.jpeg
** opel-1200-1960.jpeg
** opel-blitz-pritsche-1952.jpeg
** opel-gt-1970.jpeg
** opel-kadett-b-1970.jpeg
** opel-kapitaen-1956.jpeg
** opel-rekord-1700p1-1957.jpeg
** opel-rekord-c-1970.jpeg
** pontiac-gto-1967.jpeg
** pontiac-streamliner-1949.jpg
** renault-grand-scenic-2018.png
** volkswagen-beetle-1975.jpeg
** volkswagen-beetle-1975-2.jpeg

* Zusätzlich noch
** missing-image.png
====

=== Klassendiagramm

image::cld.png[]


=== Entity-Relationship-Diagramm

image::erd.png[]

* Für die Vergabe der werden Sequenz-Objekte verwendet, die automatisch um je 1 hochgezählt werden.
** Vehicle: Java Name: `vehicleSeq`, SQL Name: `VE_VEHICLE_SEQ`
** Image: Java Name: `imageSeq`, SQL Name: `VE_IMAGE_SEQ`, Beginnwert: 1000

* Eine Constraint auf Tabellenebene (`UQ_VEHICLE_BRAND_MODEL`) verhindert, dass zwei Fahrzeuge mit der gleichen Marke und dem gleichen Modell angelegt werden können.

=== Initialisieren der Datenbank

Beim Starten der Anwendung wird die Datenbank automatisch mit einigen Fahrzeugen initialisiert.

* Tabelle VE_VHEHICLE
+
image::table-vehicle-init.png[]

* Tabelle VE_IMAGE
+
image::table-image-init.png[]

Zum Speichern der Bilder verwenden sie KEIN SQL-Skript, sondern speichern die Bilder aus einer Java Methode heraus in die DB.

TIP: Beachten Sie, dass noch keine Bilder in die Tabelle gespeichert werden. Diese sind separat hochzuladen.

=== Repositories

image::cld-repos.png[]

* uploadImage(...) gibt die Id des ev. erstellten Image-Datensatzes zurück. wird die vehicleId nicht gefunden wird die `VehicleNotFoundException` geworfen.
+
TIP: Hierfür steht ein Unit-Test zur Verfügung.


* initializeDatabase() löscht alle Datensätze in den Tabellen `VE_VEHICLE` und `VE_IMAGE` und fügt die Initial-Datensätze wieder hinzu.

* insertDataIntoVehicleAndImage() fügt die Initial-Datensätze in die Tabellen `VE_VEHICLE` und `VE_IMAGE` ein.

* findByBrandAndModel(): Sucht Fahrzeuge nach Marke und Modell. Es wird jenes Fahrzeug zurückgegeben, das den Suchkriterien entspricht.



=== REST-API

* Swagger: http://localhost:8090/q/swagger-ui/

* Verwenden sie dtos für die Kommunikation zwischen Frontend und Backend.

to be continued ...


=== Frontend


to be continued ...







